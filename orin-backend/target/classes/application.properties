# ORIN Backend - Main Configuration
# This file contains common configuration shared across all environments
# Environment-specific settings are in application-{profile}.properties

spring.application.name=orin-backend

# Active Profile (default to dev, override with SPRING_PROFILES_ACTIVE env var)
spring.profiles.active=${SPRING_PROFILES_ACTIVE:dev}

# Server Configuration
server.port=${SERVER_PORT:8080}
server.tomcat.max-http-post-size=100MB

# Common JPA Settings
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# Common Actuator Settings
management.server.port=${SERVER_PORT:8080}
management.metrics.export.prometheus.enabled=true

# Application Info
info.app.name=ORIN Backend
info.app.description=Advanced Agent Management & Monitoring System
info.app.version=1.0.0-SNAPSHOT

# Cache Configuration
spring.cache.type=redis
spring.data.redis.time-to-live=3600000
# Redis Connection (Defaults, override in Env or Profile)
spring.data.redis.host=${REDIS_HOST:localhost}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.password=${REDIS_PASSWORD:}
spring.data.redis.database=${REDIS_DB:0}

# Distributed Tracing Configuration
management.tracing.enabled=true
management.zipkin.tracing.enabled=true
management.tracing.sampling.probability=1.0
management.zipkin.tracing.endpoint=http://localhost:9411/api/v2/spans

# Milvus Configuration
milvus.host=${MILVUS_HOST:localhost}
milvus.port=${MILVUS_PORT:19530}
milvus.token=${MILVUS_TOKEN:}
milvus.collection.default=orin_default_collection

# Security Configuration
orin.security.cors.allowed-origins=${CORS_ALLOWED_ORIGINS:*}

# Resilience4j Configuration
resilience4j.circuitbreaker.instances.siliconFlow.failure-rate-threshold=50
resilience4j.circuitbreaker.instances.siliconFlow.minimum-number-of-calls=5
resilience4j.circuitbreaker.instances.siliconFlow.automatic-transition-from-open-to-half-open-enabled=true
resilience4j.circuitbreaker.instances.siliconFlow.wait-duration-in-open-state=10s
resilience4j.circuitbreaker.instances.siliconFlow.permitted-number-of-calls-in-half-open-state=3
resilience4j.circuitbreaker.instances.siliconFlow.sliding-window-size=10
resilience4j.circuitbreaker.instances.siliconFlow.sliding-window-type=COUNT_BASED

resilience4j.retry.instances.siliconFlow.max-attempts=3

# SiliconFlow Configuration
siliconflow.api.key=${SILICONFLOW_API_KEY:sk-placeholder}
siliconflow.api.base-url=${SILICONFLOW_BASE_URL:https://api.siliconflow.cn/v1}
siliconflow.embedding.model=${SILICONFLOW_EMBEDDING_MODEL:BAAI/bge-m3}
siliconflow.vlm.model=${SILICONFLOW_VLM_MODEL:Qwen/Qwen2-VL-72B-Instruct}

# Multipart Configuration (Increase limits for Base64/Images)
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=12MB
