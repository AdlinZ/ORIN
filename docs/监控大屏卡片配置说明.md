# 监控大屏卡片化配置功能

## 功能概述

监控大屏现在支持**个性化卡片配置**，用户可以根据自己的需求自定义显示哪些监控模块。

## 使用方法

### 1. 打开配置面板
在监控大屏右上角，点击 **"自定义面板"** 按钮，打开卡片配置抽屉。

### 2. 选择需要显示的卡片

配置面板分为两个部分：

#### 统计卡片
- **智能体总数**：显示系统中所有智能体数量
- **今日请求**：显示当日 API 调用总量
- **Token 消耗**：显示累计 Token 使用量
- **平均延迟**：显示系统响应时间

#### 监控模块
- **智能体实例**：活跃智能体列表与状态
- **分布统计**：智能体类型与状态分布图表
- **活动日志**：最近系统活动记录
- **服务器硬件** ⭐ **新增**：Dify 服务器 CPU/内存/磁盘监控

### 3. 保存配置
- 配置会**自动保存**到浏览器本地存储
- 下次访问时会自动应用您的配置
- 点击 **"恢复默认"** 可以重置为系统默认配置

## 服务器硬件监控卡片

新增的服务器硬件监控卡片提供以下信息：

### 实时监控指标
- **CPU 使用率**：显示 CPU 占用百分比和核心数
- **内存使用**：显示内存占用情况和总容量
- **磁盘占用**：显示磁盘使用率和剩余空间
- **网络流量**：显示实时上传/下载速率

### 系统信息
- 操作系统版本
- 服务器运行时长
- 服务器 IP 地址

### 自动刷新
- 硬件信息每 **30 秒**自动刷新一次
- 确保数据实时性

## 配置持久化

用户的卡片配置保存在 `localStorage` 中，键名为 `dashboard_card_config`。

### 默认配置
```json
[
  "stat-agents",
  "stat-requests", 
  "stat-tokens",
  "stat-latency",
  "module-agents",
  "module-distribution",
  "module-activity"
]
```

### 包含服务器监控的配置
```json
[
  "stat-agents",
  "stat-requests",
  "stat-tokens", 
  "stat-latency",
  "module-agents",
  "module-distribution",
  "module-activity",
  "module-server"
]
```

## 后端 API

### 服务器硬件信息接口
```
GET /api/v1/monitor/server-hardware
```

**响应示例：**
```json
{
  "online": true,
  "cpuUsage": 45,
  "cpuCores": 8,
  "cpuFreq": "3.2 GHz",
  "memoryUsage": 62,
  "memoryUsed": "12.5 GB",
  "memoryTotal": "32 GB",
  "diskUsage": 58,
  "diskUsed": "256 GB",
  "diskTotal": "512 GB",
  "networkUpload": "2.3 MB/s",
  "networkDownload": "5.7 MB/s",
  "os": "Ubuntu 22.04 LTS",
  "uptime": "15天 8小时",
  "host": "192.168.1.100"
}
```

## 技术实现

### 前端组件
- `DashboardCardConfig.vue`：卡片配置抽屉组件
- `ServerHardwareCard.vue`：服务器硬件监控卡片
- `MonitorDashboard.vue`：主监控大屏（已更新支持动态卡片）

### 状态管理
- 使用 `localStorage` 进行配置持久化
- 响应式更新，配置更改立即生效

### 条件渲染
- 使用 `v-if` 和 `v-show` 根据配置动态显示/隐藏卡片
- 优化性能，未启用的模块不会渲染

## 使用场景

### 场景 1：专注于智能体管理
如果您主要关注智能体的运行状态，可以只启用：
- 智能体总数
- 智能体实例
- 活动日志

### 场景 2：性能监控
如果您需要监控系统性能，可以启用：
- Token 消耗
- 平均延迟
- 服务器硬件
- 分布统计

### 场景 3：本地部署监控
如果您使用本地 Dify 服务器，建议启用：
- 所有统计卡片
- 服务器硬件
- 智能体实例

### 场景 4：云端部署
如果使用云端 Dify 服务（无需关注硬件），可以禁用：
- 服务器硬件

## 注意事项

1. **服务器硬件监控**需要后端实现对应的 API 接口
2. 如果后端接口未实现，组件会使用**模拟数据**进行展示
3. 配置仅保存在当前浏览器，更换浏览器或清除缓存会重置为默认配置
4. 建议至少保留一个统计卡片和一个监控模块以保持界面完整性
